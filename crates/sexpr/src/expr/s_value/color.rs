use super::Svalue;

/// A sexpr to create rgb value, the storage value is normalized.
#[derive(Debug, Clone, Copy, PartialEq, PartialOrd)]
#[cfg_attr(feature = "serde", derive(serde::Serialize, serde::Deserialize))]
pub struct Srgb(pub f32, pub f32, pub f32);

impl From<(u8, u8, u8)> for Srgb {
    fn from(value: (u8, u8, u8)) -> Self {
        let (r, g, b) = value;

        Srgb::rgb(r, g, b)
    }
}

impl Srgb {
    /// Create a new `Srgb` instance from (red,green,blue) components.
    pub const fn rgb(red: u8, green: u8, blue: u8) -> Self {
        Self(
            red as f32 / 255f32,
            green as f32 / 255f32,
            blue as f32 / 255f32,
        )
    }
}

/// Recognized color keyword names, compliant with svg 1.1.
#[allow(non_camel_case_types)]
#[derive(Clone, Copy, PartialEq, Eq, PartialOrd, Ord)]
#[cfg_attr(feature = "serde", derive(serde::Serialize, serde::Deserialize))]
pub enum Color {
    aliceblue,
    antiquewhite,
    aqua,
    aquamarine,
    azure,
    beige,
    bisque,
    black,
    blanchedalmond,
    blue,
    blueviolet,
    brown,
    burlywood,
    cadetblue,
    chartreuse,
    chocolate,
    coral,
    cornflowerblue,
    cornsilk,
    crimson,
    cyan,
    darkblue,
    darkcyan,
    darkgoldenrod,
    darkgray,
    darkgreen,
    darkgrey,
    darkkhaki,
    darkmagenta,
    darkolivegreen,
    darkorange,
    darkorchid,
    darkred,
    darksalmon,
    darkseagreen,
    darkslateblue,
    darkslategray,
    darkslategrey,
    darkturquoise,
    darkviolet,
    deeppink,
    deepskyblue,
    dimgray,
    dimgrey,
    dodgerblue,
    firebrick,
    floralwhite,
    forestgreen,
    fuchsia,
    gainsboro,
    ghostwhite,
    gold,
    goldenrod,
    gray,
    grey,
    green,
    greenyellow,
    honeydew,
    hotpink,
    indianred,
    indigo,
    ivory,
    khaki,
    lavender,
    lavenderblush,
    lawngreen,
    lemonchiffon,
    lightblue,
    lightcoral,
    lightcyan,
    lightgoldenrodyellow,
    lightgray,
    lightgreen,
    lightgrey,
    lightpink,
    lightsalmon,
    lightseagreen,
    lightskyblue,
    lightslategray,
    lightslategrey,
    lightsteelblue,
    lightyellow,
    lime,
    limegreen,
    linen,
    magenta,
    maroon,
    mediumaquamarine,
    mediumblue,
    mediumorchid,
    mediumpurple,
    mediumseagreen,
    mediumslateblue,
    mediumspringgreen,
    mediumturquoise,
    mediumvioletred,
    midnightblue,
    mintcream,
    mistyrose,
    moccasin,
    navajowhite,
    navy,
    oldlace,
    olive,
    olivedrab,
    orange,
    orangered,
    orchid,
    palegoldenrod,
    palegreen,
    paleturquoise,
    palevioletred,
    papayawhip,
    peachpuff,
    peru,
    pink,
    plum,
    powderblue,
    purple,
    red,
    rosybrown,
    royalblue,
    saddlebrown,
    salmon,
    sandybrown,
    seagreen,
    seashell,
    sienna,
    silver,
    skyblue,
    slateblue,
    slategray,
    slategrey,
    snow,
    springgreen,
    steelblue,
    tan,
    teal,
    thistle,
    tomato,
    turquoise,
    violet,
    wheat,
    white,
    whitesmoke,
    yellow,
    yellowgreen,
}

impl From<Color> for Srgb {
    fn from(value: Color) -> Self {
        match value {
            Color::aliceblue => Srgb::rgb(240, 248, 255),
            Color::antiquewhite => Srgb::rgb(250, 235, 215),
            Color::aqua => Srgb::rgb(0, 255, 255),
            Color::aquamarine => Srgb::rgb(127, 255, 212),
            Color::azure => Srgb::rgb(240, 255, 255),
            Color::beige => Srgb::rgb(245, 245, 220),
            Color::bisque => Srgb::rgb(255, 228, 196),
            Color::black => Srgb::rgb(0, 0, 0),
            Color::blanchedalmond => Srgb::rgb(255, 235, 205),
            Color::blue => Srgb::rgb(0, 0, 255),
            Color::blueviolet => Srgb::rgb(138, 43, 226),
            Color::brown => Srgb::rgb(165, 42, 42),
            Color::burlywood => Srgb::rgb(222, 184, 135),
            Color::cadetblue => Srgb::rgb(95, 158, 160),
            Color::chartreuse => Srgb::rgb(127, 255, 0),
            Color::chocolate => Srgb::rgb(210, 105, 30),
            Color::coral => Srgb::rgb(255, 127, 80),
            Color::cornflowerblue => Srgb::rgb(100, 149, 237),
            Color::cornsilk => Srgb::rgb(255, 248, 220),
            Color::crimson => Srgb::rgb(220, 20, 60),
            Color::cyan => Srgb::rgb(0, 255, 255),
            Color::darkblue => Srgb::rgb(0, 0, 139),
            Color::darkcyan => Srgb::rgb(0, 139, 139),
            Color::darkgoldenrod => Srgb::rgb(184, 134, 11),
            Color::darkgray => Srgb::rgb(169, 169, 169),
            Color::darkgreen => Srgb::rgb(0, 100, 0),
            Color::darkgrey => Srgb::rgb(169, 169, 169),
            Color::darkkhaki => Srgb::rgb(189, 183, 107),
            Color::darkmagenta => Srgb::rgb(139, 0, 139),
            Color::darkolivegreen => Srgb::rgb(85, 107, 47),
            Color::darkorange => Srgb::rgb(255, 140, 0),
            Color::darkorchid => Srgb::rgb(153, 50, 204),
            Color::darkred => Srgb::rgb(139, 0, 0),
            Color::darksalmon => Srgb::rgb(233, 150, 122),
            Color::darkseagreen => Srgb::rgb(143, 188, 143),
            Color::darkslateblue => Srgb::rgb(72, 61, 139),
            Color::darkslategray => Srgb::rgb(47, 79, 79),
            Color::darkslategrey => Srgb::rgb(47, 79, 79),
            Color::darkturquoise => Srgb::rgb(0, 206, 209),
            Color::darkviolet => Srgb::rgb(148, 0, 211),
            Color::deeppink => Srgb::rgb(255, 20, 147),
            Color::deepskyblue => Srgb::rgb(0, 191, 255),
            Color::dimgray => Srgb::rgb(105, 105, 105),
            Color::dimgrey => Srgb::rgb(105, 105, 105),
            Color::dodgerblue => Srgb::rgb(30, 144, 255),
            Color::firebrick => Srgb::rgb(178, 34, 34),
            Color::floralwhite => Srgb::rgb(255, 250, 240),
            Color::forestgreen => Srgb::rgb(34, 139, 34),
            Color::fuchsia => Srgb::rgb(255, 0, 255),
            Color::gainsboro => Srgb::rgb(220, 220, 220),
            Color::ghostwhite => Srgb::rgb(248, 248, 255),
            Color::gold => Srgb::rgb(255, 215, 0),
            Color::goldenrod => Srgb::rgb(218, 165, 32),
            Color::gray => Srgb::rgb(128, 128, 128),
            Color::grey => Srgb::rgb(128, 128, 128),
            Color::green => Srgb::rgb(0, 128, 0),
            Color::greenyellow => Srgb::rgb(173, 255, 47),
            Color::honeydew => Srgb::rgb(240, 255, 240),
            Color::hotpink => Srgb::rgb(255, 105, 180),
            Color::indianred => Srgb::rgb(205, 92, 92),
            Color::indigo => Srgb::rgb(75, 0, 130),
            Color::ivory => Srgb::rgb(255, 255, 240),
            Color::khaki => Srgb::rgb(240, 230, 140),
            Color::lavender => Srgb::rgb(230, 230, 250),
            Color::lavenderblush => Srgb::rgb(255, 240, 245),
            Color::lawngreen => Srgb::rgb(124, 252, 0),
            Color::lemonchiffon => Srgb::rgb(255, 250, 205),
            Color::lightblue => Srgb::rgb(173, 216, 230),
            Color::lightcoral => Srgb::rgb(240, 128, 128),
            Color::lightcyan => Srgb::rgb(224, 255, 255),
            Color::lightgoldenrodyellow => Srgb::rgb(250, 250, 210),
            Color::lightgray => Srgb::rgb(211, 211, 211),
            Color::lightgreen => Srgb::rgb(144, 238, 144),
            Color::lightgrey => Srgb::rgb(211, 211, 211),
            Color::lightpink => Srgb::rgb(255, 182, 193),
            Color::lightsalmon => Srgb::rgb(255, 160, 122),
            Color::lightseagreen => Srgb::rgb(32, 178, 170),
            Color::lightskyblue => Srgb::rgb(135, 206, 250),
            Color::lightslategray => Srgb::rgb(119, 136, 153),
            Color::lightslategrey => Srgb::rgb(119, 136, 153),
            Color::lightsteelblue => Srgb::rgb(176, 196, 222),
            Color::lightyellow => Srgb::rgb(255, 255, 224),
            Color::lime => Srgb::rgb(0, 255, 0),
            Color::limegreen => Srgb::rgb(50, 205, 50),
            Color::linen => Srgb::rgb(250, 240, 230),
            Color::magenta => Srgb::rgb(255, 0, 255),
            Color::maroon => Srgb::rgb(128, 0, 0),
            Color::mediumaquamarine => Srgb::rgb(102, 205, 170),
            Color::mediumblue => Srgb::rgb(0, 0, 205),
            Color::mediumorchid => Srgb::rgb(186, 85, 211),
            Color::mediumpurple => Srgb::rgb(147, 112, 219),
            Color::mediumseagreen => Srgb::rgb(60, 179, 113),
            Color::mediumslateblue => Srgb::rgb(123, 104, 238),
            Color::mediumspringgreen => Srgb::rgb(0, 250, 154),
            Color::mediumturquoise => Srgb::rgb(72, 209, 204),
            Color::mediumvioletred => Srgb::rgb(199, 21, 133),
            Color::midnightblue => Srgb::rgb(25, 25, 112),
            Color::mintcream => Srgb::rgb(245, 255, 250),
            Color::mistyrose => Srgb::rgb(255, 228, 225),
            Color::moccasin => Srgb::rgb(255, 228, 181),
            Color::navajowhite => Srgb::rgb(255, 222, 173),
            Color::navy => Srgb::rgb(0, 0, 128),
            Color::oldlace => Srgb::rgb(253, 245, 230),
            Color::olive => Srgb::rgb(128, 128, 0),
            Color::olivedrab => Srgb::rgb(107, 142, 35),
            Color::orange => Srgb::rgb(255, 165, 0),
            Color::orangered => Srgb::rgb(255, 69, 0),
            Color::orchid => Srgb::rgb(218, 112, 214),
            Color::palegoldenrod => Srgb::rgb(238, 232, 170),
            Color::palegreen => Srgb::rgb(152, 251, 152),
            Color::paleturquoise => Srgb::rgb(175, 238, 238),
            Color::palevioletred => Srgb::rgb(219, 112, 147),
            Color::papayawhip => Srgb::rgb(255, 239, 213),
            Color::peachpuff => Srgb::rgb(255, 218, 185),
            Color::peru => Srgb::rgb(205, 133, 63),
            Color::pink => Srgb::rgb(255, 192, 203),
            Color::plum => Srgb::rgb(221, 160, 221),
            Color::powderblue => Srgb::rgb(176, 224, 230),
            Color::purple => Srgb::rgb(128, 0, 128),
            Color::red => Srgb::rgb(255, 0, 0),
            Color::rosybrown => Srgb::rgb(188, 143, 143),
            Color::royalblue => Srgb::rgb(65, 105, 225),
            Color::saddlebrown => Srgb::rgb(139, 69, 19),
            Color::salmon => Srgb::rgb(250, 128, 114),
            Color::sandybrown => Srgb::rgb(244, 164, 96),
            Color::seagreen => Srgb::rgb(46, 139, 87),
            Color::seashell => Srgb::rgb(255, 245, 238),
            Color::sienna => Srgb::rgb(160, 82, 45),
            Color::silver => Srgb::rgb(192, 192, 192),
            Color::skyblue => Srgb::rgb(135, 206, 235),
            Color::slateblue => Srgb::rgb(106, 90, 205),
            Color::slategray => Srgb::rgb(112, 128, 144),
            Color::slategrey => Srgb::rgb(112, 128, 144),
            Color::snow => Srgb::rgb(255, 250, 250),
            Color::springgreen => Srgb::rgb(0, 255, 127),
            Color::steelblue => Srgb::rgb(70, 130, 180),
            Color::tan => Srgb::rgb(210, 180, 140),
            Color::teal => Srgb::rgb(0, 128, 128),
            Color::thistle => Srgb::rgb(216, 191, 216),
            Color::tomato => Srgb::rgb(255, 99, 71),
            Color::turquoise => Srgb::rgb(64, 224, 208),
            Color::violet => Srgb::rgb(238, 130, 238),
            Color::wheat => Srgb::rgb(245, 222, 179),
            Color::white => Srgb::rgb(255, 255, 255),
            Color::whitesmoke => Srgb::rgb(245, 245, 245),
            Color::yellow => Srgb::rgb(255, 255, 0),
            Color::yellowgreen => Srgb::rgb(154, 205, 50),
        }
    }
}

impl From<Color> for Svalue {
    fn from(value: Color) -> Self {
        Self::Rgb(value.into())
    }
}

impl From<Srgb> for Svalue {
    fn from(value: Srgb) -> Self {
        Self::Rgb(value)
    }
}

impl TryFrom<Svalue> for Srgb {
    type Error = Svalue;
    fn try_from(value: Svalue) -> Result<Self, Self::Error> {
        match value {
            Svalue::Rgb(v) => Ok(v),
            _ => Err(value),
        }
    }
}
